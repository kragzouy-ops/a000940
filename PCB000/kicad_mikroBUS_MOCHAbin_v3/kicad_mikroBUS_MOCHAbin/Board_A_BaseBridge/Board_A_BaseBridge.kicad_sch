(kicad_sch (version 20211014) (generator "ChatGPT")
  (paper "A4")
  (title_block
    (title "MOCHAbin Base/Bridge (Board A)")
    (date "2025-10-14")
    (rev "A0")
    (company "Starter skeleton")
    (comment 1 "Expose Pi-style 40-pin upward header @3V3 via level shifting")
    (comment 2 "See pin_map.csv for default mapping")
    (comment 3 "Populate power + protection + translators on this board")
  )

  ; Upward 40-pin header to Board B (female stacking on PCB)
  (symbol (lib_id "Connector_Generic:Conn_02x20_Odd_Even") (at 60 100 0) (unit 1)
    (in_bom yes) (on_board yes) (uuid 0e4fc05a-e8ae-4fbd-8019-43c871685017)
    (property "Reference" "JHAT" (at 60 75 0))
    (property "Value" "RPi_40pin_UpHeader_3V3_Logic" (at 60 125 0))
    (property "Footprint" "Connector_PinSocket_2.54mm:PinSocket_2x20_P2.54mm_Vertical" (at 60 130 0))
  )

  ; Generic MOCHAbin GPIO/low-voltage connector (to be customized)
  (symbol (lib_id "Connector_Generic:Conn_02x10_Odd_Even") (at 170 80 180) (unit 1)
    (in_bom yes) (on_board yes) (uuid c38e2940-515d-4d67-8ffb-554ec3845d94)
    (property "Reference" "JMOCHA" (at 170 55 180))
    (property "Value" "MOCHAbin_IO(1.8V or 3.3V)" (at 170 105 180))
    (property "Footprint" "Connector_PinHeader_2.54mm:PinHeader_2x10_P2.54mm_Vertical" (at 170 110 180))
  )

  ; DC input for buck regulator (placeholder)
  (symbol (lib_id "Connector_Generic:Conn_01x02") (at 30 40 0) (unit 1)
    (in_bom yes) (on_board yes) (uuid 294fef06-0c6e-41a6-b75b-008345f87312)
    (property "Reference" "JVIN" (at 30 30 0))
    (property "Value" "VIN_12V" (at 30 50 0))
    (property "Footprint" "Connector_Molex:Molex_KK-254_AE-6410-02A_1x02_P2.54mm_Vertical" (at 30 55 0))
  )

  ; USB device connector for optional bridge path (footprint to be chosen later)
  (symbol (lib_id "Connector_Generic:Conn_01x05") (at 30 85 0) (unit 1)
    (in_bom yes) (on_board yes) (uuid f154e252-8dfd-4950-9c50-7fc81b3f86a8)
    (property "Reference" "JUSB_BRIDGE" (at 30 75 0))
    (property "Value" "USB2.0_BRIDGE_HDR (VBUS D- D+ ID GND)" (at 30 95 0))
    (property "Footprint" "" (at 30 100 0))
  )

  ; Notes box
  (text "Wire JMOCHA ↔ JHAT through level shifters (PCA9306 for I2C, AXC8T245 for SPI/GPIO).\nUSB bridge (FT2232H/MCP2221A) can feed the same nets when jumpers select it.\nAdd polyfuse on 5V to JHAT and per-socket polyfuses on Board B." (at 120 140 0))

  ; Mapping reminder
  (text "Defaults: CE0→Socket1 CS, CE1→Socket2 CS, PWM0→Sock1, PWM1→Sock2,\nINT: GPIO25→Sock1, GPIO24→Sock2, RST: GPIO22→Sock1, GPIO27→Sock2.\nI2C on GPIO2/3 with pull-ups on Board A." (at 120 150 0
  (wire (pts (xy 55 100) (xy 50 100)))
  (label "3V3" (at 48 100 0))
  (wire (pts (xy 55 102) (xy 50 102)))
  (label "5V" (at 48 102 0))
  (wire (pts (xy 55 104) (xy 50 104)))
  (label "GND" (at 48 104 0))

  (wire (pts (xy 65 95) (xy 70 95)))
  (label "I2C_SDA" (at 72 95 0))
  (wire (pts (xy 65 93) (xy 70 93)))
  (label "I2C_SCL" (at 72 93 0))

  (wire (pts (xy 65 91) (xy 70 91)))
  (label "SPI_MOSI" (at 72 91 0))
  (wire (pts (xy 65 89) (xy 70 89)))
  (label "SPI_MISO" (at 72 89 0))
  (wire (pts (xy 65 87) (xy 70 87)))
  (label "SPI_SCK" (at 72 87 0))
  (wire (pts (xy 65 85) (xy 70 85)))
  (label "SPI_CS0" (at 72 85 0))
  (wire (pts (xy 65 83) (xy 70 83)))
  (label "SPI_CS1" (at 72 83 0))

  (wire (pts (xy 65 81) (xy 70 81)))
  (label "UART_TX" (at 72 81 0))
  (wire (pts (xy 65 79) (xy 70 79)))
  (label "UART_RX" (at 72 79 0))

  (wire (pts (xy 65 77) (xy 70 77)))
  (label "PWM0" (at 72 77 0))
  (wire (pts (xy 65 75) (xy 70 75)))
  (label "PWM1" (at 72 75 0))

  (wire (pts (xy 65 73) (xy 70 73)))
  (label "INT1" (at 72 73 0))
  (wire (pts (xy 65 71) (xy 70 71)))
  (label "INT2" (at 72 71 0))
  (wire (pts (xy 65 69) (xy 70 69)))
  (label "RST1" (at 72 69 0))
  (wire (pts (xy 65 67) (xy 70 67)))
  (label "RST2" (at 72 67 0
  ; Level shifters
  (symbol (lib_id "Interface_LevelShift:PCA9306") (at 115 85 0) (unit 1)
    (in_bom yes) (on_board yes) (uuid 60fe35e1-067c-4272-bdb0-123826b25c04)
    (property "Reference" "U20" (at 115 75 0))
    (property "Value" "PCA9306 (I2C 1.8V⇄3.3V)" (at 115 95 0))
  )
  (symbol (lib_id "Logic_LevelShift:SN74AXC8T245") (at 115 115 0) (unit 1)
    (in_bom yes) (on_board yes) (uuid e6d264f3-8bc6-4a2d-aa7d-bdf23d6b26ee)
    (property "Reference" "U21" (at 115 100 0))
    (property "Value" "AXC8T245 #1 (SPI+CS0/CS1)" (at 115 130 0))
  )
  (symbol (lib_id "Logic_LevelShift:SN74AXC8T245") (at 155 115 0) (unit 1)
    (in_bom yes) (on_board yes) (uuid f4941dcd-0ce6-4983-8f6e-935c0fa54616)
    (property "Reference" "U22" (at 155 100 0))
    (property "Value" "AXC8T245 #2 (UART/PWM/INT/RST)" (at 155 130 0))
  )
  (text "Tie VCCA to MOCHAbin_VIO (1.8V if used), VCCB to 3V3. OE# pulled up to 3V3 via 10k; DIR fixed A→B or per-signal as needed. I2C via PCA9306 with VREF1=low domain, VREF2=3V3." (at 135 140 0))

)